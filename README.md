# 批量文件重命名工具

一个功能强大的批量文件重命名工具，支持多种重命名操作和实时预览功能。

## ✨ 主要功能

### 🔄 四种重命名模式
1. **替换字符串** - 查找并替换文件名中的指定字符串
2. **添加前缀/后缀** - 为文件名添加前缀或后缀
3. **批量添加序号** - 为文件添加序号编号（支持自定义起始数字、位数、步长）
4. **删除字符** - 从指定位置删除指定数量的字符（支持从左/右开始）

### 🚀 智能功能
- **实时预览** - 输入参数后0.3秒自动显示预览效果
- **颜色标识** - 有变化的文件显示红色，无变化显示正常颜色
- **拖拽支持** - 支持直接拖拽文件和文件夹到程序窗口
- **撤销功能** - 支持撤销最近的重命名操作
- **重置参数** - 一键重置所有参数到默认值
- **多文件处理** - 支持同时处理来自不同位置的文件

### 🛡️ 安全特性
- **预览确认** - 重命名前先预览，确认无误后再执行
- **文件信息显示** - 显示文件大小、路径等详细信息
- **执行结果反馈** - 实时显示每个文件的重命名结果
- **智能跳过** - 自动跳过不符合规则的文件
- **冲突检测** - 检测目标文件名是否已存在

## 🚀 快速开始

### 环境要求
- Python 3.8+
- PyQt5
- pathlib (内置)

### 安装依赖
```bash
# 使用uv (推荐)
uv pip install -e .

# 或使用pip
pip install -e .
```

### 直接运行
```bash
python src/file_renamer/gui.py
```

## 📦 打包为可执行文件

### 安装打包工具
```bash
uv pip install pyinstaller pillow
```

### 执行打包
```bash
python scripts/build_file_prefix_adder.py
```

打包完成后，可执行文件位于 `dist/批量文件重命名工具.exe`

## 📖 使用指南

### 1. 添加文件
- **方法一**：点击工具栏的"添加文件"或"添加文件夹"按钮
- **方法二**：直接拖拽文件/文件夹到程序窗口
- **方法三**：右键菜单选择"从列表中移除"来删除不需要的文件

### 2. 选择重命名模式

#### 替换字符串
- 在"将"框中输入要查找的字符串
- 在"替换为"框中输入新的字符串
- 示例：将"IMG"替换为"照片"

#### 添加前缀/后缀
- 选择"添加为前缀"或"添加为后缀"
- 输入要添加的文本
- 示例：添加前缀"2024_"

#### 批量添加序号
- 选择序号位置（前缀/后缀）
- 设置连接符（如"_"、"-"等）
- 配置起始数字、数字位数、步长
- 示例：001_文件名.txt, 002_文件名.txt

#### 删除字符
- 选择删除方向（从左开始/从右开始）
- 设置开始位置（从1开始计数）
- 设置删除字符数
- 示例：从左第3位开始删除2个字符

### 3. 预览和执行
- 程序会自动在预览列显示重命名后的效果
- 红色文字表示文件名会发生变化
- 黑色文字表示文件名不会变化
- 确认无误后点击"执行"按钮

### 4. 其他功能
- **预览**：手动刷新预览效果
- **重置参数**：恢复所有设置到默认值
- **撤回**：撤销最近一次的重命名操作
- **清空列表**：移除所有文件

## 🎯 使用技巧

### 文件选择
- 可以勾选部分文件进行处理，未勾选的文件会被跳过
- 如果没有勾选任何文件，程序会处理所有文件
- 使用"全选/全不选"快速切换选择状态

### 预览功能
- 输入参数后会自动预览（0.3秒延迟）
- 也可以手动点击"预览"按钮
- 预览列显示的就是重命名后的文件名

### 序号功能
- 数字位数设置会在数字前补0（如设置3位：001, 002, 003）
- 步长可以设置为任意正整数（如步长为5：1, 6, 11, 16...）
- 连接符可以自定义（如"_"、"-"、"."等）

### 删除功能
- "从左开始"：位置1表示第一个字符
- "从右开始"：位置1表示最后一个字符
- 删除操作不会影响文件扩展名

## ⚠️ 注意事项

1. **备份重要文件**：程序会直接修改文件名，请提前备份重要文件
2. **文件名冲突**：如果目标文件名已存在，重命名会失败
3. **多点号文件名**：程序正确处理包含多个点号的文件名（如"1.2.3.txt"）
4. **中文支持**：完全支持中文路径和文件名
5. **撤销限制**：每次只能撤销最近一次的批量操作

## 🔧 开发说明

### 项目结构
```
work_tools/
├── src/
│   ├── file_renamer/          # 主程序目录
│   │   └── gui.py            # 主界面文件
│   └── resource/             # 资源文件
│       ├── icon.png          # 应用图标
│       └── icon.ico          # Windows图标
├── scripts/
│   └── build_file_prefix_adder.py  # 打包脚本
├── pyproject.toml            # 项目配置
└── README.md                 # 说明文档
```

### 开发环境
```bash
# 安装开发依赖
uv pip install -e ".[dev]"

# 运行程序

python src/file_renamer/gui.py
```

## 📝 更新日志

### v2.0.0
- ✨ 新增删除字符功能
- ✨ 实现自动预览功能（0.3秒延迟）
- ✨ 添加重置参数按钮
- 🐛 修复多点号文件名处理问题
- 🎨 优化用户界面和交互体验
- 📦 更新打包脚本

### v2.1.0
- ✨ 重构为批量文件重命名工具
- ✨ 新增替换字符串功能
- ✨ 新增批量序号功能
- ✨ 实现实时预览和颜色标识
- ✨ 添加撤销功能
- 🎨 全新的现代化界面设计

## 📄 许可证

本项目仅供学习和个人使用。

## 👨‍💻 作者

作者：lizeyu  
版本：v2.0.0  
©版权所有
